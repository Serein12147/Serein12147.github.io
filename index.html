<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SereinSerein's Blog</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Markdown解析库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-blue: #6a9eff;
            --secondary-blue: #4a7dff;
            --primary-green: #4cd97b;
            --secondary-green: #2db85c;
            --primary-purple: #9d7bff;
            --secondary-purple: #7d5bff;
            --light-bg: #f8f9fa;
            --dark-text: #333;
            --light-text: #fff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        body {
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-green) 50%, var(--primary-purple) 100%);
            background-attachment: fixed;
            color: var(--dark-text);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 0;
        }

        .logo {
            display: flex;
            align-items: center;
        }

        .logo h1 {
            font-size: 2.2rem;
            background: linear-gradient(45deg, var(--primary-blue), var(--primary-green), var(--primary-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-right: 1rem;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 1.5rem;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark-text);
            font-weight: 500;
            transition: color 0.3s;
            position: relative;
        }

        .nav-links a:hover {
            color: var(--primary-blue);
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(to right, var(--primary-blue), var(--primary-purple));
            transition: width 0.3s;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        main {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }

        .blog-posts {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .post {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .post:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .post h2 {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--dark-text);
            border-left: 4px solid var(--primary-blue);
            padding-left: 1rem;
        }

        .post-content {
            color: #555;
            margin-bottom: 1.5rem;
            line-height: 1.8;
        }

        .post-content img {
            max-width: 100%;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .post-content h1, .post-content h2, .post-content h3 {
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
            color: var(--dark-text);
        }

        .post-content code {
            background: rgba(106, 158, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }

        .post-content pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .post-content blockquote {
            border-left: 4px solid var(--primary-green);
            padding-left: 1rem;
            margin: 1rem 0;
            color: #666;
            font-style: italic;
        }

        .post-meta {
            display: flex;
            justify-content: space-between;
            color: #777;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            padding-top: 1rem;
        }

        .read-more {
            display: inline-block;
            background: linear-gradient(to right, var(--primary-blue), var(--primary-purple));
            color: white;
            padding: 0.5rem 1.2rem;
            border-radius: 30px;
            text-decoration: none;
            font-weight: 500;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .read-more:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(106, 158, 255, 0.4);
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .about, .categories {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .sidebar h3 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #eee;
            color: var(--dark-text);
        }

        .about-content {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-blue), var(--primary-purple));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }

        .categories ul {
            list-style: none;
        }

        .categories li {
            margin-bottom: 0.8rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px dashed #eee;
        }

        .categories a {
            text-decoration: none;
            color: #555;
            display: flex;
            justify-content: space-between;
            transition: color 0.3s;
        }

        .categories a:hover {
            color: var(--primary-blue);
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: white;
            font-size: 1.2rem;
        }

        .error {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            text-align: center;
            color: #e74c3c;
        }

        footer {
            text-align: center;
            margin-top: 3rem;
            padding: 2rem 0;
            color: white;
            font-size: 0.9rem;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .social-links a {
            color: white;
            font-size: 1.2rem;
            transition: transform 0.3s;
        }

        .social-links a:hover {
            transform: translateY(-3px);
        }

        @media (max-width: 768px) {
            main {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                text-align: center;
            }
            
            .nav-links {
                margin-top: 1rem;
                justify-content: center;
            }
            
            .nav-links li {
                margin: 0 0.8rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <h1>Serein</h1>
                    <p>没有可怕的深度，就没有美丽的水面.</p>
                </div>
                <ul class="nav-links">
                    <li><a href="#home">首页</a></li>
                    <li><a href="#articles">文章</a></li>
                    <li><a href="#about">关于</a></li>
                    <li><a href="#contact">联系</a></li>
                </ul>
            </div>
        </div>
    </header>

    <div class="container">
        <main>
            <div class="blog-posts" id="blogPosts">
                <div class="loading" id="loadingIndicator">
                    <i class="fas fa-spinner fa-spin"></i> 正在从GitHub加载文章...
                </div>
            </div>

            <div class="sidebar">
                <div class="about">
                    <h3>About</h3>
                    <div class="about-content">
                        <div class="avatar">S</div>
                        <p>Hi,I'm Serein</p>
                    </div>
                </div>

                <div class="categories">
                    <h3>文章分类</h3>
                    <ul>
                        <li><a href="#tech">技术笔记 <span>(12)</span></a></li>
                        <li><a href="#life">生活随笔 <span>(8)</span></a></li>
                        <li><a href="#reading">读书心得 <span>(5)</span></a></li>
                        <li><a href="#writing">其他文章 <span>(3)</span></a></li>
                    </ul>
                </div>
            </div>
        </main>
    </div>

    <footer>
        <div class="container">
            <p>&copy; 2023 Serein|保留所有权利.</p>
            <div class="social-links">
                <a href="https://github.com/Serein12147" target="_blank"><i class="fab fa-github"></i></a>
                <a href="https://twitter.com" target="_blank"><i class="fab fa-twitter"></i></a>
                <a href="https://weibo.com" target="_blank"><i class="fab fa-weibo"></i></a>
                <a href="https://space.bilibili.com/3493271475062788" target="_blank"><i class="fab fa-bilibili"></i></a>
            </div>
        </div>
    </footer>

    <script>
        // 配置GitHub仓库信息 - 根据您的仓库修改
        const GITHUB_CONFIG = {
            username: 'Serein12147',
            repo: 'POSTS',
            folder: 'posts',
            branch: 'main'
        };

        // 文章数据缓存
        let articles = [];

        // DOM加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 从GitHub加载文章
            loadArticlesFromGitHub();
        });

        // 从GitHub加载文章
        async function loadArticlesFromGitHub() {
            try {
                console.log('开始从GitHub加载文章...');
                
                // 获取文章列表
                const articlesList = await fetchGitHubFiles();
                console.log('获取到的文章列表:', articlesList);
                
                if (articlesList.length === 0) {
                    document.getElementById('blogPosts').innerHTML = `
                        <div class="error">
                            <h3>未找到文章</h3>
                            <p>请在GitHub仓库的"${GITHUB_CONFIG.folder}"文件夹中添加Markdown文件。</p>
                        </div>
                    `;
                    return;
                }
                
                // 加载每篇文章的内容
                await loadArticlesContent(articlesList);
                console.log('加载完成的文章:', articles);
                
                // 按日期排序文章（最新的在前）
                articles.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // 渲染文章
                renderArticles();
                
            } catch (error) {
                console.error('加载文章时出错:', error);
                document.getElementById('blogPosts').innerHTML = `
                    <div class="error">
                        <h3>加载文章失败</h3>
                        <p>请检查控制台获取详细信息，并确保GitHub配置正确。</p>
                        <p>错误信息: ${error.message}</p>
                    </div>
                `;
            }
        }

        // 从GitHub获取文件列表
        async function fetchGitHubFiles() {
            const apiUrl = `https://api.github.com/repos/${GITHUB_CONFIG.username}/${GITHUB_CONFIG.repo}/contents/${GITHUB_CONFIG.folder}?ref=${GITHUB_CONFIG.branch}`;
            console.log('请求URL:', apiUrl);
            
            const response = await fetch(apiUrl);
            
            if (!response.ok) {
                throw new Error(`GitHub API请求失败: ${response.status} ${response.statusText}`);
            }
            
            const files = await response.json();
            
            // 过滤出Markdown文件
            return files.filter(file => 
                file.name.endsWith('.md') || file.name.endsWith('.markdown')
            );
        }

        // 加载文章内容
        async function loadArticlesContent(articlesList) {
            articles = [];
            
            for (const file of articlesList) {
                try {
                    console.log(`正在加载文章: ${file.name}`);
                    
                    // 获取文件内容
                    const response = await fetch(file.download_url);
                    
                    if (!response.ok) {
                        console.warn(`无法加载文章: ${file.name}, 状态码: ${response.status}`);
                        continue;
                    }
                    
                    const content = await response.text();
                    console.log(`文章 ${file.name} 内容前100字符:`, content.substring(0, 100));
                    
                    // 解析文章元数据
                    const metadata = parseArticleMetadata(content, file);
                    
                    // 将Markdown转换为HTML
                    const htmlContent = marked.parse(metadata.content);
                    
                    // 添加到文章列表
                    articles.push({
                        id: file.sha,
                        title: metadata.title,
                        content: htmlContent,
                        excerpt: metadata.excerpt,
                        date: metadata.date,
                        category: metadata.category,
                        file: file.name
                    });
                    
                } catch (error) {
                    console.error(`加载文章 ${file.name} 时出错:`, error);
                }
            }
        }

        // 解析文章元数据
        function parseArticleMetadata(content, file) {
            // 默认元数据
            let metadata = {
                title: file.name.replace(/\.md$/, ''),
                content: content,
                excerpt: content.substring(0, 200) + '...',
                date: file.created_at || new Date().toISOString().split('T')[0],
                category: '未分类'
            };
            
            // 尝试从YAML Front Matter解析元数据
            const frontMatterMatch = content.match(/^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/);
            
            if (frontMatterMatch) {
                const frontMatter = frontMatterMatch[1];
                metadata.content = frontMatterMatch[2];
                
                // 解析标题
                const titleMatch = frontMatter.match(/title:\s*(.*)/);
                if (titleMatch) metadata.title = titleMatch[1].trim();
                
                // 解析日期
                const dateMatch = frontMatter.match(/date:\s*(.*)/);
                if (dateMatch) metadata.date = dateMatch[1].trim();
                
                // 解析分类
                const categoryMatch = frontMatter.match(/category:\s*(.*)/);
                if (categoryMatch) metadata.category = categoryMatch[1].trim();
                
                // 解析摘要
                const excerptMatch = frontMatter.match(/excerpt:\s*(.*)/);
                if (excerptMatch) {
                    metadata.excerpt = excerptMatch[1].trim();
                } else {
                    metadata.excerpt = metadata.content.substring(0, 200) + '...';
                }
            }
            
            console.log(`文章 ${file.name} 解析后的元数据:`, metadata);
            return metadata;
        }

        // 渲染文章
        function renderArticles() {
            const blogPosts = document.getElementById('blogPosts');
            
            // 移除加载指示器
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (loadingIndicator) {
                loadingIndicator.remove();
            }
            
            // 如果没有文章，显示提示
            if (articles.length === 0) {
                blogPosts.innerHTML = `
                    <div class="error">
                        <h3>暂无文章</h3>
                        <p>请检查GitHub仓库配置或稍后再试。</p>
                    </div>
                `;
                return;
            }
            
            // 渲染每篇文章
            blogPosts.innerHTML = '';
            articles.forEach(article => {
                const articleElement = document.createElement('article');
                articleElement.className = 'post';
                articleElement.innerHTML = `
                    <h2>${article.title}</h2>
                    <div class="post-content">${article.content}</div>
                    <div class="post-meta">
                        <span><i class="far fa-calendar"></i> ${formatDate(article.date)}</span>
                        <span><i class="far fa-folder"></i> ${article.category}</span>
                    </div>
                    <a href="#post-${article.id}" class="read-more">阅读更多</a>
                `;
                blogPosts.appendChild(articleElement);
            });
        }

        // 格式化日期
        function formatDate(dateString) {
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('zh-CN', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
            } catch (e) {
                return dateString;
            }
        }

        // 配置marked选项
        marked.setOptions({
            highlight: function(code, lang) {
                // 在实际应用中，您可以集成highlight.js等语法高亮库
                return code;
            },
            breaks: true,
            gfm: true
        });
    </script>
</body>
</html>
